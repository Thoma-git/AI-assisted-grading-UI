@tailwind base;
@tailwind components;
@tailwind utilities;

@layer components {
    .material-symbols-outlined {
      font-variation-settings:
      'FILL' 0,
      'wght' 400,
      'GRAD' 0,
      'opsz' 24 }
    .arrow-line {
        @apply absolute w-full h-full pointer-events-none top-0 left-0 z-10;
    }
    .glass-panel {
        @apply bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg;
    }
    .ai-confidence-bar {
      @apply h-2 rounded-full;
      background: linear-gradient(to right, #ef4444 0%, #fbbf24 50%, #34d399 100%);
    }
    .ai-confidence-marker {
      @apply absolute top-1/2 -translate-y-1/2 w-[2px] h-4 rounded-sm;
      background-color: currentColor;
      box-shadow: 0 0 5px currentColor;
    }
    .workflow-item {
        @apply relative pl-6;
    }
    .workflow-item::before {
        content: '';
        @apply absolute left-2 top-1 w-2 h-2 rounded-full bg-gray-500 border-2 border-gray-700;
    }
    .workflow-item.completed::before {
        @apply bg-green-400 border-gray-800;
    }
    .workflow-item.current::before {
        @apply bg-primary border-gray-800;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
    }
    .checkpoint-badge {
      @apply inline-flex justify-center items-center w-8 h-8 rounded-full text-sm font-semibold transition-all duration-200 border-2 text-base transform;
    }
    .checkpoint-badge:hover {
      transform: scale(1.1);
      box-shadow: 0 0 8px rgba(var(--color-value), 0.5);
    }
    .checkpoint-badge.ungraded {
      --color-value: 107, 114, 128; /* gray-500 */
    }
    .dark .checkpoint-badge.ungraded { --color-value: 55, 65, 81; /* gray-700 */ }
    .checkpoint-badge.graded {
      --color-value: 34, 197, 94; /* green-500 */
      @apply bg-success border-success text-white;
    }
    .completion-checklist-item {
        @apply relative rounded overflow-hidden;
    }
    .completion-checklist-item::after {
        content: '';
        @apply absolute left-0 right-0 bottom-0 h-px z-0;
        background-color: rgba(55, 65, 81, 0.5);
    }
    .completion-checklist-item:last-child::after {
        @apply hidden;
    }
    .filter-arrow {
        font-variation-settings: 'wght' 500, 'opsz' 28;
        color: var(--primary-light);
        @apply right-2 top-1/2 -translate-y-1/2 absolute pointer-events-none z-10;
    }
    .highlight-checkpoint {
      animation: highlight-pulse 1.5s ease-out;
    }
    @keyframes highlight-pulse {
      0%, 100% { background-color: rgba(251, 146, 60, 0); border-color: transparent; }
      50% { background-color: rgba(251, 146, 60, 0.3); border-color: #fb923c; }
    }
    #pdf-viewer-container {
      @apply relative w-full;
    }
    #pdf-page {
      @apply relative bg-white shadow-md;
    }
    #pdf-canvas {
      @apply block;
    }
    .comment-widget {
        @apply absolute flex items-start pointer-events-auto;
    }
    .comment-widget .comment-toggle {
        @apply cursor-pointer flex items-center justify-center w-9 h-9 rounded-full text-white transition-transform duration-200 z-[1];
        background-color: var(--ai-comment, #3b82f6);
        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }
    .comment-widget .comment-toggle:hover {
        transform: scale(1.1);
    }
    .comment-widget .comment-body {
        @apply absolute max-w-lg transition-all duration-200;
        left: 44px; /* icon width (36) + gap (8) */
        top: -2px; /* Align with top of icon better */
    }
    .comment-widget .comment-body.flipped {
        transform: translateX(calc(-100% - 44px));
    }
    .grading-controls .comment-widget .comment-body {
        @apply bg-white dark:bg-surface-dark border border-gray-200 dark:border-border-dark absolute rounded-lg shadow-2xl z-20;
        top: calc(100% + 8px);
    }
    .comment-widget .comment-body textarea {
        @apply bg-transparent resize-none block w-[450px] max-w-full;
        min-height: 60px;
        max-height: 250px;
    }
    .comment-widget.is-dragging {
        @apply opacity-70 cursor-grabbing;
    }
    .no-transition {
      transition: none !important;
    }
    .comment-body.hidden {
      @apply invisible opacity-0 pointer-events-none;
    }
    #comment-context-menu {
        @apply transition-opacity duration-100 ease-in-out;
    }
    #comment-context-menu.hidden {
        @apply opacity-0 pointer-events-none;
    }
    .grading-drag-handle, .comment-drag-handle {
        @apply cursor-grab;
    }
    .comment-widget.is-dragging,
    .grading-checkpoint-group.is-dragging {
        @apply opacity-70 absolute cursor-grabbing z-50;
    }
    .grading-checkpoint-group.is-dragging {
        @apply border-2 border-dashed;
        border-color: var(--primary);
    }
    #pdf-page-container {
        @apply relative;
    }

    /* Styles from index.html */
    .donut-chart {
        @apply relative w-44 h-44 rounded-full;
        background: conic-gradient(#3B82F6 0% 70%, #60A5FA 70% 80%, #86EFAC 80% 90%, #22C55E 90% 100%);
    }
    .donut-chart::before {
        content: '';
        @apply absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[110px] h-[110px] bg-gray-50 rounded-full;
    }
    .dark .donut-chart::before {
        @apply bg-gray-900;
    }
    .donut-chart-center-text {
        @apply absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-5xl font-bold text-gray-800 z-10;
    }
    .dark .donut-chart-center-text {
        @apply text-gray-50;
    }
    .donut-chart-subtext {
        @apply absolute text-sm font-medium text-gray-600 z-10 leading-tight text-center;
        top: calc(50% + 2.2rem);
        left: 50%;
        transform: translate(-50%, -50%);
    }
    .dark .donut-chart-subtext {
        @apply text-gray-300;
    }
    .ai-conf-high { @apply bg-blue-600; }
    .ai-conf-low { @apply bg-blue-400; }
    .graded-once-segment { @apply bg-green-300; }
    .graded-2plus-segment { @apply bg-green-500; }
    .progress-bar-segment {
        @apply h-full min-w-[2px];
        transition: width 0.8s ease-out;
        animation: segmentGrow 1s ease-out forwards;
    }
    .progress-bar-wrapper {
        @apply flex h-3 w-full rounded-full overflow-hidden bg-gray-200;
        animation: fadeIn 0.8s ease-out forwards;
    }
    .dark .progress-bar-wrapper {
        @apply bg-gray-600;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    @keyframes segmentGrow {
        from { width: 0; }
    }
    .milestone-item {
        @apply flex items-center p-1 rounded transition-colors duration-200;
    }
    .milestone-item:hover {
        background-color: rgba(var(--primary-rgb), 0.1);
    }
    .legend-item {
        @apply flex items-center mb-2;
    }
    .legend-color-swatch {
        @apply w-4 h-4 rounded mr-2 flex-shrink-0;
    }
    .question-card {
        @apply bg-white dark:bg-gray-800 p-2 rounded-lg shadow-sm cursor-pointer;
        transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
    }
    .question-card:hover {
        @apply -translate-y-0.5 shadow-md;
    }
    .legend-ai-high { @apply bg-[#3B82F6]; }
    .legend-ai-low { @apply bg-[#60A5FA]; }
    .legend-graded-once { @apply bg-[#86EFAC]; }
    .legend-graded-2plus { @apply bg-[#22C55E]; }
    .dark .legend-ai-high { @apply bg-blue-600; }
    .dark .legend-ai-low { @apply bg-blue-500; }
    .dark .legend-graded-once { @apply bg-green-400; }
    .dark .legend-graded-2plus { @apply bg-green-600; }
    .status-ready { @apply text-green-500; }
    .status-running { @apply text-yellow-500; }
    .status-completed { @apply text-blue-500; }
    .status-failed { @apply text-red-500; }
    .draggable-task {
        @apply cursor-grab;
    }
    .is-dragging, .draggable-task.is-dragging {
        @apply opacity-40 bg-gray-600;
    }
    .draggable-task.is-unavailable, .draggable-task.is-assigned {
        @apply opacity-50 cursor-not-allowed;
    }
    .drop-zone {
        @apply min-h-12 border-2 border-dashed border-transparent;
        transition: border-color 0.2s ease-in-out;
    }
    .drop-zone.drag-over {
        @apply border-blue-500;
    }
    .subquestion-group-header {
        @apply select-none flex items-center justify-between py-3 px-4 border-b border-gray-200 dark:border-gray-700;
        transition: background-color 0.2s ease-in-out;
    }
    .subquestion-group-header .chevron-icon {
        @apply hidden;
    }
    .subquestion-group-content {
        @apply overflow-visible max-h-none p-4;
    }
    .ta-avatar {
        @apply w-8 h-8 min-w-8 min-h-8 bg-primary text-white flex items-center justify-center rounded-full text-sm font-medium mr-2 flex-shrink-0;
    }
    .task-points {
        @apply text-xs font-medium opacity-80;
    }
    .task-label {
        @apply inline-flex items-center gap-1.5 py-2 px-3 text-sm font-semibold leading-none text-white rounded-lg min-w-36 justify-between;
    }
    .task-label > span:first-child .iteration-badge {
        @apply text-xs leading-none py-0.5 px-1.5 rounded bg-white/20 flex-shrink-0;
    }
    .subsequent-iteration-pattern {
        background-image: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.1) 50%, rgba(255, 255, 255, 0.1) 75%, transparent 75%, transparent);
        background-size: 8px 8px;
        background-color: var(--task-bg-color);
    }
    .dark .subsequent-iteration-pattern {
        background-image: linear-gradient(135deg, rgba(0, 0, 0, 0.1) 25%, transparent 25%, transparent 50%, rgba(0, 0, 0, 0.1) 50%, rgba(0, 0, 0, 0.1) 75%, transparent 75%, transparent);
    }
    .legend-pattern-item {
        background-color: var(--legend-base-color, #E5E7EB);
    }
    .dark .legend-pattern-item {
        background-color: var(--legend-base-color, #4B5563);
    }
    .ta-task-list {
        @apply flex flex-col gap-2 pl-2 list-none;
    }
    .ta-task-list li {
        @apply flex items-stretch gap-2;
    }
    .ta-task-list li .task-label {
        @apply min-w-0 flex-grow justify-between px-3;
    }
    .ta-task-list .task-order-number {
        @apply text-sm font-semibold text-gray-600 dark:text-gray-300 flex-shrink-0 w-7 text-right;
    }
    .subquestion-group-content .draggable-task {
        @apply min-w-16;
    }
    .drop-indicator {
        @apply h-0.5 bg-primary w-full my-0.5 rounded;
    }
    .ta-task-list li.drag-over-item {
        @apply outline-2 outline-primary outline-offset-2 rounded-md;
    }
    .info-tooltip-container { @apply relative; }
    .info-tooltip { @apply hidden; }
    #exam-template-viewer-container { @apply relative; }
    .template-checkpoint { @apply cursor-grab; }
    .question-item-header.selected { @apply bg-primary/10 dark:bg-primary/20; }
    .template-checkpoint.is-dragging { @apply opacity-50 cursor-grabbing z-50; }
    .template-checkpoint .points-input { -moz-appearance: textfield; }
}